<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Діагностика професійної рефлексії майбутніх керівників хореографічних колективів</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #333;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            color: white;
            padding: 40px;
            text-align: center;
        }

        .header h1 {
            font-size: 2.2em;
            margin-bottom: 15px;
            font-weight: 600;
        }

        .header p {
            font-size: 1.1em;
            opacity: 0.9;
        }

        .progress-container {
            background: #f8f9fa;
            padding: 20px;
            border-bottom: 1px solid #e9ecef;
        }

        .progress-bar {
            width: 100%;
            height: 8px;
            background: #e9ecef;
            border-radius: 10px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #4facfe, #00f2fe);
            width: 0%;
            transition: width 0.3s ease;
            border-radius: 10px;
        }

        .progress-text {
            text-align: center;
            margin-top: 10px;
            font-weight: 600;
            color: #495057;
        }

        .form-content {
            padding: 40px;
        }

        .section {
            margin-bottom: 40px;
            display: none;
        }

        .section.active {
            display: block;
            animation: fadeIn 0.5s ease-in;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .section-title {
            font-size: 1.8em;
            color: #2c3e50;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 3px solid #4facfe;
        }

        .section-description {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 30px;
            border-left: 4px solid #4facfe;
        }

        .question-group {
            margin-bottom: 25px;
            padding: 20px;
            background: #fff;
            border-radius: 10px;
            border: 1px solid #e9ecef;
            transition: all 0.3s ease;
        }

        .question-group:hover {
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            transform: translateY(-2px);
        }

        .question-text {
            font-weight: 600;
            margin-bottom: 15px;
            color: #2c3e50;
        }

        .form-group {
            margin-bottom: 20px;
        }

        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: #495057;
        }

        input[type="text"], input[type="number"], input[type="email"], select, textarea {
            width: 100%;
            padding: 12px;
            border: 2px solid #e9ecef;
            border-radius: 8px;
            font-size: 16px;
            transition: border-color 0.3s ease;
        }

        input[type="text"]:focus, input[type="number"]:focus, input[type="email"]:focus, select:focus, textarea:focus {
            outline: none;
            border-color: #4facfe;
            box-shadow: 0 0 0 3px rgba(79, 172, 254, 0.1);
        }

        .radio-group {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            margin-top: 10px;
        }

        .radio-item {
            display: flex;
            align-items: center;
            cursor: pointer;
            padding: 8px 12px;
            border-radius: 6px;
            transition: background-color 0.3s ease;
        }

        .radio-item:hover {
            background-color: #f8f9fa;
        }

        .radio-item input[type="radio"] {
            margin-right: 8px;
            transform: scale(1.2);
        }

        .scale-container {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin: 15px 0;
            flex-wrap: wrap;
        }

        .scale-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            cursor: pointer;
            padding: 10px;
            border-radius: 8px;
            transition: all 0.3s ease;
            min-width: 60px;
        }

        .scale-item:hover {
            background-color: #f8f9fa;
            transform: scale(1.05);
        }

        .scale-item input[type="radio"] {
            margin-bottom: 5px;
            transform: scale(1.3);
        }

        .scale-labels {
            display: flex;
            justify-content: space-between;
            margin-top: 10px;
            font-size: 0.9em;
            color: #6c757d;
        }

        .navigation {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 40px;
            padding-top: 20px;
            border-top: 1px solid #e9ecef;
        }

        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-block;
        }

        .btn-primary {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(79, 172, 254, 0.3);
        }

        .btn-secondary {
            background: #6c757d;
            color: white;
        }

        .btn-secondary:hover {
            background: #545b62;
            transform: translateY(-2px);
        }

        .btn:disabled {
            background: #e9ecef;
            color: #6c757d;
            cursor: not-allowed;
            transform: none;
        }

        .results-section {
            display: none;
            text-align: center;
            padding: 40px;
        }

        .results-title {
            font-size: 2em;
            color: #28a745;
            margin-bottom: 20px;
        }

        .results-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-top: 30px;
        }

        .result-card {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            border: 1px solid #e9ecef;
        }

        .result-card h4 {
            color: #2c3e50;
            margin-bottom: 10px;
        }

        .result-value {
            font-size: 1.5em;
            font-weight: bold;
            color: #4facfe;
        }

        .error {
            color: #dc3545;
            font-size: 0.9em;
            margin-top: 5px;
        }

        .required {
            color: #dc3545;
        }

        @media (max-width: 768px) {
            .container {
                margin: 10px;
                border-radius: 10px;
            }

            .header {
                padding: 20px;
            }

            .header h1 {
                font-size: 1.8em;
            }

            .form-content {
                padding: 20px;
            }

            .scale-container {
                flex-direction: column;
                gap: 10px;
            }

            .scale-item {
                min-width: auto;
                width: 100%;
            }

            .radio-group {
                flex-direction: column;
                gap: 10px;
            }

            .navigation {
                flex-direction: column;
                gap: 15px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>Діагностика професійної рефлексії майбутніх керівників хореографічних колективів</h1>
            <p>Науково-дослідне анкетування для дисертаційної роботи</p>
        </div>

        <div class="progress-container">
            <div class="progress-bar">
                <div class="progress-fill" id="progressFill"></div>
            </div>
            <div class="progress-text" id="progressText">Крок 1 з 9</div>
        </div>

        <div class="form-content">
            <form id="surveyForm">
                <!-- Секція 0: Демографічні дані -->
                <div class="section active" data-section="0">
                    <h2 class="section-title">Демографічні дані</h2>
                    <div class="section-description">
                        <p><strong>Шановні учасники!</strong></p>
                        <p>Ця анкета є частиною наукового дослідження з формування професійної рефлексії у майбутніх керівників хореографічних колективів.</p>
                        <p><strong>ВАЖЛИВА ІНФОРМАЦІЯ:</strong></p>
                        <ul>
                            <li>• Ваші відповіді конфіденційні та використовуються виключно в наукових цілях</li>
                            <li>• Час заповнення: 60-90 хвилин</li>
                            <li>• Кількість методик: 8 (191 питання)</li>
                            <li>• Можна зберегти прогрес та продовжити пізніше</li>
                        </ul>
                        <p>Дякуємо за участь у дослідженні!</p>
                    </div>

                    <div class="question-group">
                        <div class="form-group">
                            <label for="fullName">Прізвище, ім'я, по батькові <span class="required">*</span></label>
                            <input type="text" id="fullName" name="fullName" required>
                        </div>

                        <div class="form-group">
                            <label for="email">Email <span class="required">*</span></label>
                            <input type="email" id="email" name="email" required>
                        </div>

                        <div class="form-group">
                            <label>Стать</label>
                            <div class="radio-group">
                                <div class="radio-item">
                                    <input type="radio" id="genderF" name="gender" value="female">
                                    <label for="genderF">Жіноча</label>
                                </div>
                                <div class="radio-item">
                                    <input type="radio" id="genderM" name="gender" value="male">
                                    <label for="genderM">Чоловіча</label>
                                </div>
                                <div class="radio-item">
                                    <input type="radio" id="genderN" name="gender" value="not_specified">
                                    <label for="genderN">Не хочу вказувати</label>
                                </div>
                            </div>
                        </div>

                        <div class="form-group">
                            <label for="age">Вік <span class="required">*</span></label>
                            <input type="number" id="age" name="age" min="17" max="65" required>
                        </div>

                        <div class="form-group">
                            <label for="studyStatus">Курс навчання/статус</label>
                            <select id="studyStatus" name="studyStatus">
                                <option value="">Оберіть...</option>
                                <option value="bachelor1">1 курс бакалаврату</option>
                                <option value="bachelor2">2 курс бакалаврату</option>
                                <option value="bachelor3">3 курс бакалаврату</option>
                                <option value="bachelor4">4 курс бакалаврату</option>
                                <option value="master1">1 курс магістратури</option>
                                <option value="master2">2 курс магістратури</option>
                                <option value="teacher">Практикуючий педагог</option>
                                <option value="other">Інше</option>
                            </select>
                        </div>

                        <div class="form-group">
                            <label for="institution">Навчальний заклад/місце роботи <span class="required">*</span></label>
                            <input type="text" id="institution" name="institution" required>
                        </div>

                        <div class="form-group">
                            <label>Досвід роботи з хореографічними колективами</label>
                            <div class="radio-group">
                                <div class="radio-item">
                                    <input type="radio" id="exp0" name="experience" value="none">
                                    <label for="exp0">Немає досвіду</label>
                                </div>
                                <div class="radio-item">
                                    <input type="radio" id="exp1" name="experience" value="less1">
                                    <label for="exp1">Менше 1 року</label>
                                </div>
                                <div class="radio-item">
                                    <input type="radio" id="exp2" name="experience" value="1-2">
                                    <label for="exp2">1-2 роки</label>
                                </div>
                                <div class="radio-item">
                                    <input type="radio" id="exp3" name="experience" value="3-5">
                                    <label for="exp3">3-5 років</label>
                                </div>
                                <div class="radio-item">
                                    <input type="radio" id="exp4" name="experience" value="more5">
                                    <label for="exp4">Більше 5 років</label>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Секція 1: IMI -->
                <div class="section" data-section="1">
                    <h2 class="section-title">Методика 1: Опитувальник внутрішньої мотивації (IMI)</h2>
                    <div class="section-description">
                        <p><strong>Мета:</strong> Оцінка суб'єктивного досвіду щодо внутрішньої мотивації до рефлексивної діяльності.</p>
                        <p><strong>Інструкція:</strong> Для кожного твердження вкажіть, наскільки воно відповідає дійсності для вас, використовуючи шкалу від 1 до 7:</p>
                        <p>1 - зовсім не відповідає дійсності, 7 - повністю відповідає дійсності</p>
                    </div>

                    <div id="imiQuestions"></div>
                </div>

                <!-- Секція 2: CFI -->
                <div class="section" data-section="2">
                    <h2 class="section-title">Методика 2: Опитувальник когнітивної гнучкості (CFI)</h2>
                    <div class="section-description">
                        <p><strong>Мета:</strong> Оцінка здатності адаптувати мисленнєві процеси у відповідь на складні педагогічні ситуації.</p>
                        <p><strong>Інструкція:</strong> Вкажіть, наскільки кожне твердження відповідає вам у складних педагогічних або стресових ситуаціях під час роботи з хореографічним колективом:</p>
                        <p>1 – зовсім не згоден, 7 – повністю згоден</p>
                    </div>

                    <div id="cfiQuestions"></div>
                </div>

                <!-- Секція 3: MDMQ -->
                <div class="section" data-section="3">
                    <h2 class="section-title">Методика 3: Мельбурнський опитувальник прийняття рішень (MDMQ)</h2>
                    <div class="section-description">
                        <p><strong>Мета:</strong> Діагностика індивідуального стилю прийняття рішень у педагогічних та творчих ситуаціях.</p>
                        <p><strong>Інструкція:</strong> Кожне твердження описує підходи до прийняття рішень. Оберіть відповідь, що найкраще описує ваш підхід до прийняття рішень під час роботи з хореографічним колективом.</p>
                    </div>

                    <div id="mdmqQuestions"></div>
                </div>

                <!-- Секція 4: CSI -->
                <div class="section" data-section="4">
                    <h2 class="section-title">Методика 4: Індикатор копінг-стратегій (CSI)</h2>
                    <div class="section-description">
                        <p><strong>Мета:</strong> Виявлення провідних стратегій подолання складних професійних ситуацій.</p>
                        <p><strong>Інструкція:</strong> Згадайте одну складну ситуацію, з якою ви зіткнулися під час роботи з хореографічним колективом протягом останніх шести місяців. Це має бути ситуація, яка була важливою для вас і викликала занепокоєння.</p>
                        <p>1 = Зовсім ні, 2 = Трохи, 3 = Багато</p>
                    </div>

                    <div class="question-group">
                        <div class="form-group">
                            <label for="difficultSituation">Коротко опишіть цю складну професійну ситуацію: <span class="required">*</span></label>
                            <textarea id="difficultSituation" name="difficultSituation" rows="4" required></textarea>
                        </div>
                    </div>

                    <div id="csiQuestions"></div>
                </div>

                <!-- Секція 5: MIQ -->
                <div class="section" data-section="5">
                    <h2 class="section-title">Методика 5: Модифікований візуалізаційний опитувальник для хореографів (MIQ-R-Choreo)</h2>
                    <div class="section-description">
                        <p><strong>Мета:</strong> Оцінка здатності до візуалізації рухів та їх рефлексивного аналізу у трьох модальностях уявлень.</p>
                        <p><strong>Інструкція:</strong> Виконайте прості рухи та оцініть легкість уявлення:</p>
                        <ul>
                            <li><strong>Внутрішні візуальні уявлення (IVI):</strong> Уявіть, що виконуєте рух зсередини свого тіла</li>
                            <li><strong>Зовнішні візуальні уявлення (EVI):</strong> Уявіть, що виконуєте рух з боку</li>
                            <li><strong>Кінестетичні уявлення (KIN):</strong> Уявіть відчуття м'язів під час руху</li>
                        </ul>
                        <p>1 = дуже важко уявити, 7 = дуже легко уявити</p>
                    </div>

                    <div id="miqQuestions"></div>
                </div>

                <!-- Секція 6: ES -->
                <div class="section" data-section="6">
                    <h2 class="section-title">Методика 6: Шкала екзистенції (ES)</h2>
                    <div class="section-description">
                        <p><strong>Мета:</strong> Оцінка ступеня особистісної самореалізації та базового ставлення до життя у контексті професійної діяльності.</p>
                        <p><strong>Інструкція:</strong> Прочитайте кожне твердження і оцініть, наскільки воно відповідає вам у контексті вашої професійної діяльності як майбутнього керівника хореографічного колективу.</p>
                    </div>

                    <div id="esQuestions"></div>
                </div>

                <!-- Секція 7: DERS -->
                <div class="section" data-section="7">
                    <h2 class="section-title">Методика 7: Шкала труднощів у регуляції емоцій (DERS)</h2>
                    <div class="section-description">
                        <p><strong>Мета:</strong> Оцінка здатності до емоційної саморегуляції в ситуаціях творчого процесу та роботи з хореографічним колективом.</p>
                        <p><strong>Інструкція:</strong> Нижче наведено твердження про емоції та почуття. Прочитайте кожне твердження і позначте, як часто кожне з них стосується вас у контексті роботи з хореографічним колективом.</p>
                        <p>1 = Майже ніколи, 5 = Майже завжди</p>
                    </div>

                    <div id="dersQuestions"></div>
                </div>

                <!-- Секція 8: Контент-аналіз -->
                <div class="section" data-section="8">
                    <h2 class="section-title">Методика 8: Контент-аналіз хореографічних постановок</h2>
                    <div class="section-description">
                        <p><strong>Мета:</strong> Оцінка креативності, емоційної виразності та смислового наповнення створених хореографічних композицій.</p>
                        <p><strong>Інструкція:</strong> Згадайте свою останню або найбільш значущу хореографічну роботу та дайте відповіді на запитання.</p>
                    </div>

                    <div id="contentAnalysisQuestions"></div>
                </div>

                <!-- Результати -->
                <div class="results-section" id="resultsSection">
                    <h2 class="results-title">🎉 Дякуємо за участь у дослідженні!</h2>
                    <p>Ваші відповіді збережено та будуть проаналізовані в рамках наукового дослідження.</p>
                    
                    <div class="results-grid" id="resultsGrid"></div>
                    
                    <div style="margin-top: 30px;">
                        <button type="button" class="btn btn-primary" onclick="downloadResults()">Завантажити результати</button>
                        <button type="button" class="btn btn-secondary" onclick="emailResults()">Надіслати на email</button>
                    </div>
                </div>

                <div class="navigation">
                    <button type="button" class="btn btn-secondary" id="prevBtn" onclick="previousSection()" style="display: none;">Назад</button>
                    <div></div>
                    <button type="button" class="btn btn-primary" id="nextBtn" onclick="nextSection()">Далі</button>
                </div>
            </form>
        </div>
    </div>

    <script>
        // Дані питань для всіх методик
        const questionsData = {
            imi: [
                "Під час аналізу своєї роботи з танцівниками я думаю про те, як мені це подобається",
                "Я зовсім не нервую, коли осмислюю свою педагогічну діяльність",
                "Я відчуваю, що це мій вибір аналізувати власне викладання",
                "Я думаю, що досить добре вмію осмислювати свою роботу хореографа",
                "Я вважаю самоаналіз педагогічної діяльності дуже цікавим",
                "Я відчуваю напругу під час роздумів над своєю роботою",
                "Я думаю, що краще за інших студентів умію аналізувати свою діяльність",
                "Осмислювати свою роботу з учнями було цікаво",
                "Я почуваюся розслаблено, коли роздумую над своїм викладанням",
                "Мені дуже подобається аналізувати свою педагогічну діяльність",
                "Я не маю особливого вибору щодо самоаналізу своєї роботи",
                "Я задоволений тим, як умію осмислювати свою діяльність",
                "Я хвилююся, коли потрібно проаналізувати свою роботу",
                "Я вважаю самоспостереження у викладанні дуже нудним",
                "Я відчуваю, що роблю те, що хочу, коли осмислюю свою педагогічну діяльність",
                "Я відчуваю себе досить умілим у самоаналізі своєї роботи",
                "Я вважаю роздуми над своїм викладанням дуже цікавими",
                "Я відчуваю тиск, коли потрібно проаналізувати свою роботу",
                "Я відчуваю, що мушу займатися самоаналізом своєї діяльності",
                "Я б описав осмислення своєї роботи як дуже приємне",
                "Я аналізую свою педагогічну діяльність, бо не маю вибору",
                "Після роздумів над своєю роботою деякий час я відчуваю себе досить компетентним"
            ],
            cfi: [
                "Я добре вмію «оцінювати» педагогічні ситуації під час репетицій",
                "Мені важко приймати рішення, коли виникають проблеми з учнями",
                "Я розглядаю кілька варіантів, перш ніж вирішити педагогічну проблему",
                "Коли на репетиції щось йде не так, я відчуваю, що втрачаю контроль",
                "Мені подобається розглядати складні ситуації з учнями з багатьох різних точок зору",
                "Я шукаю кілька можливих варіантів, щоб допомогти вирішити проблему з танцівниками",
                "Коли виникають складності у викладанні, я просто не знаю, що робити",
                "Я враховую всі доступні факти та інформацію, коли стикаюся з педагогічною проблемою",
                "Мені важко прийняти рішення під час складних моментів на репетиції",
                "Мені подобається обдумувати всі можливі варіанти перед прийняттям педагогічного рішення",
                "Зіткнувшись зі складною ситуацією у викладанні, я не можу ясно мислити",
                "Я добре вмію придумувати творчі способи вирішення педагогічних проблем",
                "Я схильний розглядати проблеми у роботі з танцівниками з різних перспектив",
                "Я здатний подолати труднощі в педагогічній діяльності, з якими стикаюся",
                "Я відчуваю, що не маю контролю над тим, що відбувається під час складних моментів у викладанні",
                "Я можу придумати більше ніж один спосіб вирішення проблеми з учнями",
                "Мені важко думати про нові способи подолання складних ситуацій з танцівниками",
                "Я здатний досягати своїх педагогічних цілей, навіть коли зустрічаю труднощі",
                "Я можу придумати кілька способів вирішення педагогічної проблеми",
                "Я здатний справлятися з непередбачуваними ситуаціями під час роботи з колективом"
            ],
            mdmq: [
                "У мене виникає відчуття, ніби мені катастрофічно не вистачає часу під час репетицій",
                "Я вважаю за краще розглядати всі альтернативи при вирішенні педагогічних завдань",
                "Я вважаю за краще залишати прийняття важливих рішень щодо роботи з танцівниками іншим людям",
                "Я намагаюся знайти недоліки у всіх альтернативах при плануванні занять",
                "Я витрачаю багато часу на дрібні справи, перш ніж приступити до прийняття основного рішення щодо постановки",
                "Я обмірковую найкращий спосіб реалізації педагогічного рішення",
                "Навіть після прийняття рішення щодо роботи з учнями я відкладаю його виконання",
                "При прийнятті педагогічних рішень я вважаю за краще збирати велику кількість інформації",
                "Я уникаю приймати рішення щодо управління танцювальним колективом",
                "Коли мені потрібно прийняти рішення щодо учнів, я чекаю довгий час перед тим, як почати про нього думати",
                "Мені не подобається брати на себе відповідальність за прийняття рішень щодо роботи з танцівниками",
                "Я намагаюся мати чітке уявлення про свої педагогічні цілі перед тим, як зробити вибір",
                "Можливість того, що якась дрібниця піде «не за планом» під час виступу змушує мене різко змінити рішення",
                "Якщо рішення щодо роботи з учнями може бути прийняте мною чи іншою людиною, я дам іншій людині це зробити",
                "Коли я стикаюся з важкою педагогічною проблемою, я зазвичай песимістично налаштований щодо можливості знайти гарне рішення",
                "Я ретельно все обмірковую перед тим, як зробити вибір щодо викладання",
                "Я не приймаю рішення щодо роботи з танцівниками, поки в цьому немає гострої необхідності",
                "Я відкладаю прийняття педагогічних рішень до останнього моменту",
                "Я вважаю за краще, щоб рішення щодо хореографічної роботи приймалися тими, хто більш досвідчений, ніж я",
                "Після того, як я прийняв рішення щодо роботи з учнями, я витрачаю багато часу, переконуючи себе, що воно було правильним",
                "Я відкладаю прийняття рішень щодо управління колективом",
                "Я не можу мислити тверезо, якщо мені потрібно прийняти рішення щодо танцівників поспіхом"
            ],
            csi: {
                problemSolving: [
                    "Переорганізували роботу з танцівниками так, щоб проблема мала найкращі шанси бути вирішеною?",
                    "Обмірковували всі можливі педагогічні рішення перед тим, як вирішити, що робити?",
                    "Поставили собі деякі цілі для вирішення ситуації з учнями?",
                    "Дуже ретельно зважили свої варіанти дій щодо викладання?",
                    "Випробували різні педагогічні методи, поки не знайшли той, який спрацював?",
                    "Думали про те, що потрібно зробити, щоб виправити ситуацію з колективом?",
                    "Зосередили всю свою увагу на вирішенні проблеми з танцівниками?",
                    "Сформували план дій у своєму розумі щодо хореографічної роботи?",
                    "Стояли твердо і боролися за те, чого хотіли в даній ситуації з учнями?",
                    "Намагалися активно вирішити проблему у викладанні?",
                    "Намагалися ретельно спланувати курс дій, а не діяти імпульсивно?"
                ],
                socialSupport: [
                    "Дали волю своїм почуттям перед колегою чи другом?",
                    "Прийняли співчуття та розуміння від когось щодо ситуації?",
                    "Розмовляли з людьми про ситуацію, тому що розмова допомогла вам почуватися краще?",
                    "Довірили свої страхи та занепокоєння щодо роботи другу чи колезі?",
                    "Розповіли людям про ситуацію, тому що розмова допомогла знайти рішення?",
                    "Звернулися до когось (колеги чи професіонала), щоб допомогти собі почуватися краще?",
                    "Пішли до колеги, щоб він допоміг вам почуватися краще щодо проблеми?",
                    "Пішли до досвідченого педагога за порадою, як змінити ситуацію?",
                    "Прийняли співчуття та розуміння від колег, які мали подібну проблему?",
                    "Прийняли допомогу від колеги чи наставника?",
                    "Шукали підтримку від тих, хто знає вас найкраще?"
                ],
                avoidance: [
                    "Намагалися відволіктися від проблеми з танцівниками?",
                    "Робили все можливе, щоб інші не бачили, наскільки все насправді погано?",
                    "Мріяли про кращі часи у хореографічній роботі?",
                    "Проводили більше часу, ніж зазвичай, наодинці?",
                    "Дивилися телевізор більше, ніж зазвичай?",
                    "Уникали спілкування з колегами взагалі?",
                    "Поглинали себе хобі чи іншою діяльністю, щоб уникнути думок про проблему?",
                    "Спали більше, ніж зазвичай?",
                    "Фантазували про те, як все могло б бути по-іншому у викладанні?",
                    "Втікали в книги чи фільми, щоб не думати про проблему?",
                    "Бажали, щоб люди просто залишили вас у спокої?"
                ]
            },
            miq: [
                { movement: "Рух руки", type: "Внутрішні візуальні", text: "Я міг чітко бачити рух у своєму розумі зі своєї точки зору" },
                { movement: "Рух руки", type: "Зовнішні візуальні", text: "Я міг чітко бачити рух у своєму розумі з зовнішньої перспективи" },
                { movement: "Рух руки", type: "Кінестетичні", text: "Я міг чітко відчувати себе, що виконую рух" },
                { movement: "Рух ноги", type: "Внутрішні візуальні", text: "Я міг чітко бачити рух у своєму розумі зі своєї точки зору" },
                { movement: "Рух ноги", type: "Зовнішні візуальні", text: "Я міг чітко бачити рух у своєму розумі з зовнішньої перспективи" },
                { movement: "Рух ноги", type: "Кінестетичні", text: "Я міг чітко відчувати себе, що виконую рух" },
                { movement: "Стрибок", type: "Внутрішні візуальні", text: "Я міг чітко бачити рух у своєму розумі зі своєї точки зору" },
                { movement: "Стрибок", type: "Зовнішні візуальні", text: "Я міг чітко бачити рух у своєму розумі з зовнішньої перспективи" },
                { movement: "Стрибок", type: "Кінестетичні", text: "Я міг чітко відчувати себе, що виконую рух" },
                { movement: "Нахил", type: "Внутрішні візуальні", text: "Я міг чітко бачити рух у своєму розумі зі своєї точки зору" },
                { movement: "Нахил", type: "Зовнішні візуальні", text: "Я міг чітко бачити рух у своєму розумі з зовнішньої перспективи" },
                { movement: "Нахил", type: "Кінестетичні", text: "Я міг чітко відчувати себе, що виконую рух" }
            ],
            es: [
                "Часто я кидаю навіть важливу хореографічну роботу, якщо зусилля, які потрібні, стають надто неприємними",
                "Я відчуваю, що ті завдання у викладанні, які переді мною стоять, мають для мене значення",
                "Для мене щось має значення у професійній діяльності лише тоді, коли це відповідає моєму бажанню",
                "У моїй роботі з танцівниками немає нічого цінного",
                "Найбільше мені подобається займатися самим собою – моїми турботами, бажаннями, мріями про хореографічну роботу",
                "Зазвичай я буваю розсіяний під час викладання",
                "Навіть якщо я багато зробив для учнів, я не задоволений, тому що відчуваю, що не зробив того, що було важливим",
                "Я завжди орієнтуюся на очікування інших щодо хореографічної роботи і поступаю відповідно до цього",
                "Мені властиво відкладати неприємні рішення щодо танцівників на потім",
                "Мене легко відволікти від педагогічної роботи, навіть якщо я зайнятий тим, що мені подобається",
                "У моїй професійній діяльності немає нічого такого, чому я хотів би себе присвятити",
                "Я часто не розумію, чому саме я маю працювати хореографом",
                "Я думаю, що те життя, яке я веду як майбутній керівник, ні на що не придатне",
                "Мені важко розуміти сенс роботи з танцювальним колективом",
                "Я можу поводитися з самим собою як з добрим другом у професійній діяльності",
                "Я надто мало часу приділяю тому, що є по-справжньому важливим у хореографічній роботі",
                "У мене відразу ніколи не буває ясності з приводу того, що я можу зробити в будь-якій ситуації з учнями",
                "Я багато роблю у викладанні тільки тому, що я маю це робити, а не тому, що я хочу це зробити",
                "Якщо виникають проблеми з танцівниками, я легко втрачаю голову",
                "Я часто роблю те у хореографічній роботі, що можна з таким самим успіхом зробити і пізніше",
                "Мені щоразу цікаво, що принесе день роботи з колективом",
                "Найчастіше, тільки почавши діяти з учнями, я розумію, які наслідки має прийняте рішення",
                "Якщо я повинен ухвалити рішення щодо танцівників, я не можу покластися на свої почуття",
                "Невпевненість у результаті хореографічної роботи утримує мене від її виконання",
                "Я ніколи точно не знаю, за що я відповідаю у роботі з колективом",
                "Я почуваюся внутрішньо вільним у своїй професійній діяльності",
                "Через те, що педагогічна робота не дала виповнитися моїм бажанням, я відчуваю себе обділеним",
                "Коли я бачу, що не маю вибору у викладанні, я відчуваю полегшення",
                "Є ситуації у роботі з танцівниками, в яких я почуваюся зовсім безпорадним",
                "Я роблю багато такого у хореографічній роботі, в чому я по-справжньому не розбираюся",
                "Зазвичай я не знаю, що у ситуації з учнями є важливим",
                "Виконання власних бажань стоїть для мене на першому місці у викладанні",
                "Мені важко перейнятися почуттями танцівників",
                "Було б краще, якби я не працював хореографом",
                "Багато з того, з чим я пов'язаний у педагогічній роботі, чуже мені",
                "Мені подобається формувати власну думку щодо хореографічної діяльності",
                "Я відчуваю, що розриваюся, бо водночас роблю так багато речей у роботі з колективом",
                "Мені не вистачає сил, щоб довести до кінця навіть найважливіші речі у викладанні",
                "Я роблю багато у хореографічній роботі просто так, особливо не замислюючись",
                "Ситуація з танцівниками для мене лише тоді представляє інтерес, коли вона відповідає моїм бажанням",
                "Коли я хворію, то не знаю, що робити з часом, відведеним для педагогічної роботи",
                "Я рідко бачу, що у викладанні я маю різні можливості для дії",
                "Я знаходжу роботу з танцювальним колективом одноманітною",
                "Питання, чи хочу я щось зробити для учнів, рідко постає переді мною, тому що найчастіше є те, що я повинен робити",
                "У моїй хореографічній роботі немає нічого дійсно хорошого, тому що все має свої плюси та мінуси",
                "Моя внутрішня несвобода і залежність у професійній діяльності завдають мені багато клопоту"
            ],
            ders: [
                "Я чітко розумію свої почуття під час викладання",
                "Я звертаю увагу на те, як почуваюся під час хореографічної діяльності",
                "Я відчуваю свої емоції як непереборні та неконтрольовані під час роботи з учнями",
                "Я не маю уявлення, як я себе почуваю під час педагогічної діяльності",
                "Мені важко розібратися у своїх почуттях щодо роботи з танцівниками",
                "Я уважний до своїх почуттів під час хореографічної діяльності",
                "Я точно знаю, що я відчуваю під час роботи з колективом",
                "Мені важливо, що я відчуваю під час педагогічної діяльності",
                "Мене бентежить те, що я відчуваю під час роботи з колективом",
                "Коли я засмучений через роботу з колективом, я усвідомлюю свої емоції",
                "Коли я засмучений через викладання, я злюся на себе за те, що почуваюся так",
                "Коли я засмучений через роботу з учнями, мені стає ніяково через це почуття",
                "Коли я засмучений, мені важко виконувати хореографічну роботу",
                "Коли я засмучений через педагогічну діяльність, я втрачаю контроль",
                "Коли я засмучений через роботи з танцівниками, я вірю, що залишусь таким ще довгий час",
                "Коли я засмучений через викладання, я вважаю, що зрештою почуватимуся дуже пригніченим",
                "Коли я засмучений через роботу з учнями, я вважаю, що мої почуття дійсні та важливі",
                "Коли я засмучений, мені важко зосередитися на хореографічній роботі",
                "Коли я засмучений через педагогічну діяльність, я відчуваю себе неконтрольованим",
                "Коли я засмучений, я все одно можу довести роботу з танцівниками до кінця",
                "Коли я засмучений через викладання, мені соромно за це",
                "Коли я засмучений через роботу з учнями, я знаю, що зможу знайти спосіб почуватися краще",
                "Коли я засмучений через педагогічну діяльність, я відчуваю себе слабким",
                "Коли я засмучений через роботу з танцівниками, я відчуваю, що можу контролювати свою поведінку",
                "Коли я засмучений через викладання, я відчуваю провину за те, що так себе почуваю",
                "Коли я засмучений, мені важко зосередитися на хореографічній роботі",
                "Коли я засмучений через педагогічну діяльність, мені важко контролювати свою поведінку",
                "Коли я засмучений через роботу з учнями, я вважаю, що нічого не можу зробити, щоб почуватися краще",
                "Коли я засмучений через викладання, я дратуюся на себе через те, що відчуваю себе так",
                "Коли я засмучений через роботу з танцівниками, я починаю відчувати себе дуже погано",
                "Коли я засмучений через педагогічну діяльність, я вважаю, що все, що я можу зробити, – це занурюватися в це почуття",
                "Коли я засмучений через роботу з учнями, я втрачаю контроль над своєю поведінкою",
                "Коли я засмучений, мені важко думати про щось інше, крім хореографічної роботи",
                "Коли я засмучений через викладання, мені потрібен час, щоб зрозуміти, що я насправді відчуваю",
                "Коли я засмучений через педагогічну діяльність, мені потрібно багато часу, щоб відчути себе краще",
                "Коли я засмучений через роботу з танцівниками, мої емоції переповнюють мене"
            ]
        };

        // Глобальні змінні
        let currentSection = 0;
        let formData = {};
        const totalSections = 9;

        // Ініціалізація форми
        document.addEventListener('DOMContentLoaded', function() {
            generateQuestions();
            updateProgress();
            loadSavedData();
        });

        // Генерація питань для всіх методик
        function generateQuestions() {
            generateIMIQuestions();
            generateCFIQuestions();
            generateMDMQQuestions();
            generateCSIQuestions();
            generateMIQQuestions();
            generateESQuestions();
            generateDERSQuestions();
            generateContentAnalysisQuestions();
        }

        // Генерація питань IMI
        function generateIMIQuestions() {
            const container = document.getElementById('imiQuestions');
            questionsData.imi.forEach((question, index) => {
                const questionDiv = createScaleQuestion(`imi_${index + 1}`, `${index + 1}. ${question}`, 1, 7);
                container.appendChild(questionDiv);
            });
        }

        // Генерація питань CFI
        function generateCFIQuestions() {
            const container = document.getElementById('cfiQuestions');
            questionsData.cfi.forEach((question, index) => {
                const questionDiv = createScaleQuestion(`cfi_${index + 1}`, `${index + 1}. ${question}`, 1, 7);
                container.appendChild(questionDiv);
            });
        }

        // Генерація питань MDMQ
        function generateMDMQQuestions() {
            const container = document.getElementById('mdmqQuestions');
            questionsData.mdmq.forEach((question, index) => {
                const questionDiv = createMultipleChoiceQuestion(
                    `mdmq_${index + 1}`, 
                    `${index + 1}. ${question}`,
                    ['Так', 'Іноді', 'Ні']
                );
                container.appendChild(questionDiv);
            });
        }

        // Генерація питань CSI
        function generateCSIQuestions() {
            const container = document.getElementById('csiQuestions');
            
            // Розв'язання проблем
            const problemSolvingDiv = document.createElement('div');
            problemSolvingDiv.innerHTML = '<h4>Розв\'язання проблем</h4><p>Якою мірою ви...</p>';
            container.appendChild(problemSolvingDiv);
            
            questionsData.csi.problemSolving.forEach((question, index) => {
                const questionDiv = createScaleQuestion(`csi_problem_${index + 1}`, `${index + 1}. ${question}`, 1, 3);
                container.appendChild(questionDiv);
            });

            // Пошук соціальної підтримки
            const supportDiv = document.createElement('div');
            supportDiv.innerHTML = '<h4 style="margin-top: 30px;">Пошук соціальної підтримки</h4><p>Якою мірою ви...</p>';
            container.appendChild(supportDiv);
            
            questionsData.csi.socialSupport.forEach((question, index) => {
                const questionDiv = createScaleQuestion(`csi_support_${index + 1}`, `${index + 12}. ${question}`, 1, 3);
                container.appendChild(questionDiv);
            });

            // Уникнення
            const avoidanceDiv = document.createElement('div');
            avoidanceDiv.innerHTML = '<h4 style="margin-top: 30px;">Уникнення</h4><p>Якою мірою ви...</p>';
            container.appendChild(avoidanceDiv);
            
            questionsData.csi.avoidance.forEach((question, index) => {
                const questionDiv = createScaleQuestion(`csi_avoidance_${index + 1}`, `${index + 23}. ${question}`, 1, 3);
                container.appendChild(questionDiv);
            });
        }

        // Генерація питань MIQ
        function generateMIQQuestions() {
            const container = document.getElementById('miqQuestions');
            let currentMovement = '';
            
            questionsData.miq.forEach((item, index) => {
                if (item.movement !== currentMovement) {
                    currentMovement = item.movement;
                    const movementDiv = document.createElement('div');
                    movementDiv.innerHTML = `<h4 style="margin-top: 30px;">${item.movement}</h4>`;
                    container.appendChild(movementDiv);
                }
                
                const questionDiv = createScaleQuestion(
                    `miq_${index + 1}`, 
                    `${item.type}: ${item.text}`, 
                    1, 7
                );
                container.appendChild(questionDiv);
            });
        }

        // Генерація питань ES
        function generateESQuestions() {
            const container = document.getElementById('esQuestions');
            const options = ['вірно', 'вірно за рідкісними винятками', 'скоріше вірно', 'скоріше не вірно', 'не вірно за рідкісними винятками', 'не вірно'];
            
            questionsData.es.forEach((question, index) => {
                const questionDiv = createMultipleChoiceQuestion(`es_${index + 1}`, `${index + 1}. ${question}`, options);
                container.appendChild(questionDiv);
            });
        }

        // Генерація питань DERS
        function generateDERSQuestions() {
            const container = document.getElementById('dersQuestions');
            questionsData.ders.forEach((question, index) => {
                const questionDiv = createScaleQuestion(`ders_${index + 1}`, `${index + 1}. ${question}`, 1, 5);
                container.appendChild(questionDiv);
            });
        }

        // Генерація питань контент-аналізу
        function generateContentAnalysisQuestions() {
            const container = document.getElementById('contentAnalysisQuestions');
            
            // Базова інформація
            const basicInfo = `
                <div class="question-group">
                    <h4>Базова інформація про роботу</h4>
                    <div class="form-group">
                        <label for="workTitle">Назва постановки:</label>
                        <input type="text" id="workTitle" name="workTitle">
                    </div>
                    <div class="form-group">
                        <label for="musicSupport">Музичний супровід:</label>
                        <input type="text" id="musicSupport" name="musicSupport">
                    </div>
                    <div class="form-group">
                        <label for="performersCount">Кількість виконавців:</label>
                        <input type="text" id="performersCount" name="performersCount">
                    </div>
                    <div class="form-group">
                        <label for="duration">Тривалість:</label>
                        <input type="text" id="duration" name="duration">
                    </div>
                </div>
            `;
            container.innerHTML = basicInfo;

            // Концептуальна основа
            const conceptDiv = createMultipleChoiceQuestion('concept_basis', '1. Концептуальна основа роботи:', [
                'Особистий емоційний досвід або спогади',
                'Соціальна проблема або суспільне явище',
                'Літературний твір, поезія, філософська ідея',
                'Музичний образ або характер композиції',
                'Абстрактна гра з формою, рухом і простором',
                'Експеримент з новою технікою або стилем',
                'Інше'
            ]);
            container.appendChild(conceptDiv);

            // Джерело творчого імпульсу
            const impulseDiv = createMultipleChoiceQuestion('creative_impulse', '2. Джерело творчого імпульсу:', [
                'Глибоке особисте переживання',
                'Професійне завдання або виклик',
                'Натхнення від побаченого мистецького твору',
                'Спонтанна ідея під час прослуховування музики',
                'Результат тривалого творчого пошуку',
                'Бажання передати конкретне послання'
            ]);
            container.appendChild(impulseDiv);

            // Рівень новизни та оригінальності
            const noveltyDiv = createMultipleChoiceQuestion('novelty_level', '3. Рівень новизни та оригінальності:', [
                'Створив принципово новий підхід до теми',
                'Поєднав відомі елементи у незвичний спосіб',
                'Дав власну інтерпретацію традиційної теми',
                'Використав класичні прийоми з незначними змінами',
                'Відтворив добре відомі зразки'
            ]);
            container.appendChild(noveltyDiv);

            // Технічна складність
            const complexityDiv = createMultipleChoiceQuestion('technical_complexity', '4. Технічна складність реалізації:', [
                'Виходив за межі своїх поточних можливостей',
                'Використовував складні технічні елементи впевнено',
                'Поєднував прості елементи в складну композицію',
                'Працював в межах освоєних технік',
                'Обмежився базовими рухами та прийомами'
            ]);
            container.appendChild(complexityDiv);

            // Емоційно-смислова насиченість
            const emotionalDiv = createMultipleChoiceQuestion('emotional_content', '5. Емоційно-смислова насиченість:', [
                'Багаторівневий смисл з можливістю різних інтерпретацій',
                'Чітко структурований смисл з підтекстом',
                'Прямий смисл з емоційними нюансами',
                'Простий, легко зрозумілий смисл',
                'Переважно формальний підхід без глибокого змісту'
            ]);
            container.appendChild(emotionalDiv);

            // Усвідомленість творчого процесу
            const awarenessDiv = createMultipleChoiceQuestion('process_awareness', '6. Усвідомленість творчого процесу:', [
                'Повний контроль над кожним етапом створення',
                'Чітке розуміння основних творчих рішень',
                'Часткове усвідомлення процесу з інтуїтивними моментами',
                'Переважно інтуїтивне створення з окремими рефлексіями',
                'Спонтанне створення без аналізу процесу'
            ]);
            container.appendChild(awarenessDiv);

            // Здатність до самокритичного аналізу
            const selfCriticDiv = createMultipleChoiceQuestion('self_critical_analysis', '7. Здатність до самокритичного аналізу:', [
                'Об\'єктивно оцінюю як сильні, так і слабкі сторони',
                'Критично аналізую з переважанням самокритики',
                'Здатен побачити очевидні недоліки та переваги',
                'Схильний до переоцінки власної роботи',
                'Важко даю об\'єктивну оцінку своїй роботі'
            ]);
            container.appendChild(selfCriticDiv);

            // Розуміння впливу на глядача
            const audienceDiv = createMultipleChoiceQuestion('audience_impact', '8. Розуміння впливу на глядача:', [
                'Точно прогнозую емоційну реакцію різних глядачів',
                'Розумію загальний характер впливу на аудиторію',
                'Маю приблизне уявлення про можливі реакції',
                'Слабо уявляю, як сприйматиме глядач',
                'Не думав про реакцію глядачів'
            ]);
            container.appendChild(audienceDiv);
        }

        // Функція створення питання зі шкалою
        function createScaleQuestion(name, questionText, min, max) {
            const questionDiv = document.createElement('div');
            questionDiv.className = 'question-group';
            
            const labels = [];
            if (max === 7) {
                labels.push('зовсім не відповідає', 'повністю відповідає');
            } else if (max === 5) {
                labels.push('майже ніколи', 'майже завжди');
            } else if (max === 3) {
                labels.push('зовсім ні', 'багато');
            }

            let scaleHTML = `
                <div class="question-text">${questionText}</div>
                <div class="scale-container">
            `;

            for (let i = min; i <= max; i++) {
                scaleHTML += `
                    <div class="scale-item">
                        <input type="radio" id="${name}_${i}" name="${name}" value="${i}" required>
                        <label for="${name}_${i}">${i}</label>
                    </div>
                `;
            }

            scaleHTML += `</div>`;
            
            if (labels.length > 0) {
                scaleHTML += `
                    <div class="scale-labels">
                        <span>${labels[0]}</span>
                        <span>${labels[1]}</span>
                    </div>
                `;
            }

            questionDiv.innerHTML = scaleHTML;
            return questionDiv;
        }

        // Функція створення питання з множинним вибором
        function createMultipleChoiceQuestion(name, questionText, options) {
            const questionDiv = document.createElement('div');
            questionDiv.className = 'question-group';
            
            let html = `<div class="question-text">${questionText}</div><div class="radio-group">`;
            
            options.forEach((option, index) => {
                html += `
                    <div class="radio-item">
                        <input type="radio" id="${name}_${index}" name="${name}" value="${option}" required>
                        <label for="${name}_${index}">${option}</label>
                    </div>
                `;
            });
            
            html += '</div>';
            questionDiv.innerHTML = html;
            return questionDiv;
        }

        // Навігація між секціями
        function nextSection() {
            if (validateCurrentSection()) {
                saveCurrentSectionData();
                
                if (currentSection === totalSections - 1) {
                    // Остання секція - показати результати
                    calculateAndShowResults();
                } else {
                    currentSection++;
                    showSection(currentSection);
                    updateProgress();
                    updateNavigationButtons();
                }
            }
        }

        function previousSection() {
            if (currentSection > 0) {
                saveCurrentSectionData();
                currentSection--;
                showSection(currentSection);
                updateProgress();
                updateNavigationButtons();
            }
        }

        function showSection(sectionIndex) {
            // Приховати всі секції
            const sections = document.querySelectorAll('.section');
            sections.forEach(section => {
                section.classList.remove('active');
            });
            
            // Показати поточну секцію
            const currentSectionElement = document.querySelector(`[data-section="${sectionIndex}"]`);
            if (currentSectionElement) {
                currentSectionElement.classList.add('active');
            }
            
            // Прокрутити до верху
            window.scrollTo(0, 0);
        }

        function updateProgress() {
            const progressPercentage = (currentSection / (totalSections - 1)) * 100;
            document.getElementById('progressFill').style.width = `${progressPercentage}%`;
            document.getElementById('progressText').textContent = `Крок ${currentSection + 1} з ${totalSections}`;
        }

        function updateNavigationButtons() {
            const prevBtn = document.getElementById('prevBtn');
            const nextBtn = document.getElementById('nextBtn');
            
            if (currentSection === 0) {
                prevBtn.style.display = 'none';
            } else {
                prevBtn.style.display = 'inline-block';
            }
            
            if (currentSection === totalSections - 1) {
                nextBtn.textContent = 'Завершити анкетування';
            } else {
                nextBtn.textContent = 'Далі';
            }
        }

        // Валідація поточної секції
        function validateCurrentSection() {
            const currentSectionElement = document.querySelector(`[data-section="${currentSection}"]`);
            const requiredInputs = currentSectionElement.querySelectorAll('input[required], select[required], textarea[required]');
            
            let isValid = true;
            
            requiredInputs.forEach(input => {
                if (input.type === 'radio') {
                    const radioGroup = currentSectionElement.querySelectorAll(`input[name="${input.name}"]`);
                    const isChecked = Array.from(radioGroup).some(radio => radio.checked);
                    if (!isChecked) {
                        isValid = false;
                        showValidationError(input, 'Це поле обов\'язкове для заповнення');
                    } else {
                        clearValidationError(input);
                    }
                } else {
                    if (!input.value.trim()) {
                        isValid = false;
                        showValidationError(input, 'Це поле обов\'язкове для заповнення');
                    } else {
                        clearValidationError(input);
                    }
                }
            });
            
            return isValid;
        }

        function showValidationError(input, message) {
            clearValidationError(input);
            const errorDiv = document.createElement('div');
            errorDiv.className = 'error';
            errorDiv.textContent = message;
            input.closest('.form-group, .question-group').appendChild(errorDiv);
        }

        function clearValidationError(input) {
            const errorDiv = input.closest('.form-group, .question-group').querySelector('.error');
            if (errorDiv) {
                errorDiv.remove();
            }
        }

        // Збереження даних
        function saveCurrentSectionData() {
            const currentSectionElement = document.querySelector(`[data-section="${currentSection}"]`);
            const inputs = currentSectionElement.querySelectorAll('input, select, textarea');
            
            inputs.forEach(input => {
                if (input.type === 'radio' && input.checked) {
                    formData[input.name] = input.value;
                } else if (input.type !== 'radio') {
                    formData[input.name] = input.value;
                }
            });
            
            // Зберегти в localStorage
            try {
                localStorage.setItem('choreographyReflectionSurvey', JSON.stringify(formData));
            } catch (e) {
                console.log('Не вдалося зберегти дані в localStorage');
            }
        }

        function loadSavedData() {
            try {
                const savedData = localStorage.getItem('choreographyReflectionSurvey');
                if (savedData) {
                    formData = JSON.parse(savedData);
                    
                    // Відновити значення полів
                    Object.keys(formData).forEach(key => {
                        const input = document.querySelector(`[name="${key}"]`);
                        if (input) {
                            if (input.type === 'radio') {
                                const radioButton = document.querySelector(`[name="${key}"][value="${formData[key]}"]`);
                                if (radioButton) {
                                    radioButton.checked = true;
                                }
                            } else {
                                input.value = formData[key];
                            }
                        }
                    });
                }
            } catch (e) {
                console.log('Не вдалося завантажити збережені дані');
            }
        }

        // Розрахунок результатів
        function calculateAndShowResults() {
            saveCurrentSectionData();
            
            const results = {
                imi: calculateIMI(),
                cfi: calculateCFI(),
                mdmq: calculateMDMQ(),
                csi: calculateCSI(),
                miq: calculateMIQ(),
                es: calculateES(),
                ders: calculateDERS(),
                content: calculateContentAnalysis()
            };
            
            // Розрахунок компонентів професійної рефлексії
            const components = calculateReflectionComponents(results);
            
            // Відправити дані на сервер/Google Sheets
            submitDataToServer(formData, results, components);
            
            // Показати результати
            showResults(results, components);
        }

        // Функція відправки даних на сервер
        async function submitDataToServer(formData, results, components) {
            // ВАРІАНТ 1: Google Apps Script Web App
            const GOOGLE_SCRIPT_URL = 'ВСТАВТЕ_ВАШ_GOOGLE_SCRIPT_URL_СЮДИ';
            
            const submissionData = {
                timestamp: new Date().toISOString(),
                participantData: {
                    fullName: formData.fullName,
                    email: formData.email,
                    gender: formData.gender,
                    age: formData.age,
                    studyStatus: formData.studyStatus,
                    institution: formData.institution,
                    experience: formData.experience
                },
                rawResponses: formData,
                calculatedResults: results,
                reflectionComponents: components,
                finalScores: {
                    motivational: components.motivational,
                    cognitive: components.cognitive,
                    operational: components.operational,
                    creative: components.creative,
                    overall: components.overall,
                    level: getReflectionLevel(components.overall)
                }
            };

            try {
                // Спроба відправки на Google Apps Script
                const response = await fetch(GOOGLE_SCRIPT_URL, {
                    method: 'POST',
                    mode: 'no-cors',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(submissionData)
                });
                
                console.log('Дані успішно відправлено на сервер');
                
                // Показати повідомлення про успішну відправку
                showSubmissionSuccess();
                
            } catch (error) {
                console.error('Помилка відправки даних:', error);
                
                // Резервний варіант - email
                showSubmissionError();
                
                // Автоматично підготувати email з даними
                prepareEmailSubmission(submissionData);
            }

            // ВАРІАНТ 2: Відправка на власний сервер (якщо у вас є)
            // try {
            //     const response = await fetch('https://your-server.com/api/survey-submission', {
            //         method: 'POST',
            //         headers: {
            //             'Content-Type': 'application/json',
            //             'Authorization': 'Bearer YOUR_API_KEY'
            //         },
            //         body: JSON.stringify(submissionData)
            //     });
            //     
            //     if (response.ok) {
            //         console.log('Дані відправлено на сервер');
            //     }
            // } catch (error) {
            //     console.error('Помилка відправки:', error);
            // }

            // ВАРІАНТ 3: Відправка на email через EmailJS
            // await sendEmailWithResults(submissionData);
        }

        function showSubmissionSuccess() {
            const notification = document.createElement('div');
            notification.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                background: #28a745;
                color: white;
                padding: 15px 20px;
                border-radius: 8px;
                box-shadow: 0 4px 12px rgba(0,0,0,0.15);
                z-index: 1000;
                font-weight: 600;
            `;
            notification.textContent = '✅ Ваші відповіді успішно відправлено дослідникові!';
            document.body.appendChild(notification);
            
            setTimeout(() => {
                document.body.removeChild(notification);
            }, 5000);
        }

        function showSubmissionError() {
            const notification = document.createElement('div');
            notification.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                background: #dc3545;
                color: white;
                padding: 15px 20px;
                border-radius: 8px;
                box-shadow: 0 4px 12px rgba(0,0,0,0.15);
                z-index: 1000;
                font-weight: 600;
            `;
            notification.innerHTML = '⚠️ Помилка відправки. Дані збережено локально.<br>Натисніть "Надіслати на email" нижче.';
            document.body.appendChild(notification);
            
            setTimeout(() => {
                document.body.removeChild(notification);
            }, 8000);
        }

        function prepareEmailSubmission(data) {
            // Підготувати детальний email з усіма результатами
            const emailBody = `
РЕЗУЛЬТАТИ ДІАГНОСТИКИ ПРОФЕСІЙНОЇ РЕФЛЕКСІЇ

=== ІНФОРМАЦІЯ ПРО УЧАСНИКА ===
ПІБ: ${data.participantData.fullName}
Email: ${data.participantData.email}
Стать: ${data.participantData.gender}
Вік: ${data.participantData.age}
Статус: ${data.participantData.studyStatus}
Заклад: ${data.participantData.institution}
Досвід: ${data.participantData.experience}
Дата проходження: ${data.timestamp}

=== КОМПОНЕНТИ ПРОФЕСІЙНОЇ РЕФЛЕКСІЇ ===
Мотиваційно-ціннісний: ${data.finalScores.motivational.toFixed(3)}
Когнітивно-аналітичний: ${data.finalScores.cognitive.toFixed(3)}
Операційно-діяльнісний: ${data.finalScores.operational.toFixed(3)}
Творчо-регулятивний: ${data.finalScores.creative.toFixed(3)}

ЗАГАЛЬНИЙ РІВЕНЬ: ${data.finalScores.overall.toFixed(3)} (${data.finalScores.level})

=== РЕЗУЛЬТАТИ ЗА МЕТОДИКАМИ ===
IMI (Внутрішня мотивація):
- Інтерес: ${data.calculatedResults.imi.interest.toFixed(3)}
- Компетентність: ${data.calculatedResults.imi.competence.toFixed(3)}
- Вибір: ${data.calculatedResults.imi.choice.toFixed(3)}
- Тиск: ${data.calculatedResults.imi.pressure.toFixed(3)}

CFI (Когнітивна гнучкість):
- Альтернативи: ${data.calculatedResults.cfi.alternatives}
- Контроль: ${data.calculatedResults.cfi.control}
- Загальний: ${data.calculatedResults.cfi.total}

MDMQ (Прийняття рішень):
- Пильність: ${data.calculatedResults.mdmq.vigilance}
- Уникнення: ${data.calculatedResults.mdmq.avoidance}
- Прокрастинація: ${data.calculatedResults.mdmq.procrastination}
- Гіперпільність: ${data.calculatedResults.mdmq.hypervigilance}

CSI (Копінг-стратегії):
- Розв'язання проблем: ${data.calculatedResults.csi.problemSolving.toFixed(3)}
- Соціальна підтримка: ${data.calculatedResults.csi.socialSupport.toFixed(3)}
- Уникнення: ${data.calculatedResults.csi.avoidance.toFixed(3)}

MIQ (Візуалізація):
- Внутрішні візуальні: ${data.calculatedResults.miq.internalVisual.toFixed(3)}
- Зовнішні візуальні: ${data.calculatedResults.miq.externalVisual.toFixed(3)}
- Кінестетичні: ${data.calculatedResults.miq.kinesthetic.toFixed(3)}

ES (Екзистенція): ${data.calculatedResults.es.total.toFixed(3)}
DERS (Регуляція емоцій): ${data.calculatedResults.ders.total}
Контент-аналіз: ${data.calculatedResults.content.total.toFixed(3)}

=== СИРІ ДАНІ ===
${JSON.stringify(data.rawResponses, null, 2)}
`;

            // Відкрити email клієнт з підготовленими даними
            const mailto = `mailto:ВАШ_EMAIL@gmail.com?subject=${encodeURIComponent('Результати дослідження професійної рефлексії - ' + data.participantData.fullName)}&body=${encodeURIComponent(emailBody)}`;
            
            // Також створити резервну кнопку
            const emailButton = document.createElement('button');
            emailButton.className = 'btn btn-primary';
            emailButton.style.marginTop = '20px';
            emailButton.textContent = '📧 Відправити результати дослідникові';
            emailButton.onclick = () => window.open(mailto);
            
            document.querySelector('.results-section .btn-primary').parentNode.insertBefore(emailButton, document.querySelector('.results-section .btn-primary'));
        }

        function calculateIMI() {
            const interest = [1,5,8,10,14,17,20].map(i => {
                const value = parseInt(formData[`imi_${i}`] || 0);
                return i === 14 ? (8 - value) : value; // зворотне кодування для питання 14
            });
            
            const competence = [4,7,12,16,22].map(i => parseInt(formData[`imi_${i}`] || 0));
            
            const choice = [3,11,15,19,21].map(i => {
                const value = parseInt(formData[`imi_${i}`] || 0);
                return [11,19,21].includes(i) ? (8 - value) : value; // зворотне кодування
            });
            
            const pressure = [2,6,9,13,18].map(i => {
                const value = parseInt(formData[`imi_${i}`] || 0);
                return [2,9].includes(i) ? (8 - value) : value; // зворотне кодування
            });
            
            return {
                interest: average(interest),
                competence: average(competence),
                choice: average(choice),
                pressure: average(pressure),
                total: (average(interest) + average(competence) + average(choice) - average(pressure)) / 3
            };
        }

        function calculateCFI() {
            const alternatives = [1,3,5,6,8,10,12,13,16,18,19,20].map(i => parseInt(formData[`cfi_${i}`] || 0));
            const control = [2,4,7,9,11,15,17].map(i => {
                const value = parseInt(formData[`cfi_${i}`] || 0);
                return 8 - value; // зворотне кодування
            });
            
            return {
                alternatives: sum(alternatives),
                control: sum(control),
                total: sum(alternatives) + sum(control)
            };
        }

        function calculateMDMQ() {
            const vigilance = [2,6,8,12,16].map(i => {
                const value = formData[`mdmq_${i}`];
                return value === 'Так' ? 2 : value === 'Іноді' ? 1 : 0;
            });
            
            const avoidance = [3,11,14,19].map(i => {
                const value = formData[`mdmq_${i}`];
                return value === 'Так' ? 2 : value === 'Іноді' ? 1 : 0;
            });
            
            const procrastination = [7,9,17,18,21].map(i => {
                const value = formData[`mdmq_${i}`];
                return value === 'Так' ? 2 : value === 'Іноді' ? 1 : 0;
            });
            
            const hypervigilance = [1,13,15,20,22].map(i => {
                const value = formData[`mdmq_${i}`];
                return value === 'Так' ? 2 : value === 'Іноді' ? 1 : 0;
            });
            
            return {
                vigilance: sum(vigilance),
                avoidance: sum(avoidance),
                procrastination: sum(procrastination),
                hypervigilance: sum(hypervigilance)
            };
        }

        function calculateCSI() {
            const problemSolving = [];
            for (let i = 1; i <= 11; i++) {
                problemSolving.push(parseInt(formData[`csi_problem_${i}`] || 0));
            }
            
            const socialSupport = [];
            for (let i = 1; i <= 11; i++) {
                socialSupport.push(parseInt(formData[`csi_support_${i}`] || 0));
            }
            
            const avoidance = [];
            for (let i = 1; i <= 11; i++) {
                avoidance.push(parseInt(formData[`csi_avoidance_${i}`] || 0));
            }
            
            return {
                problemSolving: average(problemSolving),
                socialSupport: average(socialSupport),
                avoidance: average(avoidance)
            };
        }

        function calculateMIQ() {
            const internalVisual = [1,4,7,10].map(i => parseInt(formData[`miq_${i}`] || 0));
            const externalVisual = [2,5,8,11].map(i => parseInt(formData[`miq_${i}`] || 0));
            const kinesthetic = [3,6,9,12].map(i => parseInt(formData[`miq_${i}`] || 0));
            
            return {
                internalVisual: average(internalVisual),
                externalVisual: average(externalVisual),
                kinesthetic: average(kinesthetic),
                total: (average(internalVisual) + average(externalVisual) + average(kinesthetic)) / 3
            };
        }

        function calculateES() {
            // Більшість питань потребують зворотного кодування
            const reverseItems = [1,3,4,5,6,7,9,10,11,12,13,14,16,17,18,19,20,22,23,24,25,27,28,29,30,31,33,34,35,37,38,39,40,41,42,43,44,45,46];
            
            let total = 0;
            for (let i = 1; i <= 46; i++) {
                const value = formData[`es_${i}`];
                let score = 0;
                
                switch(value) {
                    case 'вірно': score = reverseItems.includes(i) ? 1 : 6; break;
                    case 'вірно за рідкісними винятками': score = reverseItems.includes(i) ? 2 : 5; break;
                    case 'скоріше вірно': score = reverseItems.includes(i) ? 3 : 4; break;
                    case 'скоріше не вірно': score = reverseItems.includes(i) ? 4 : 3; break;
                    case 'не вірно за рідкісними винятками': score = reverseItems.includes(i) ? 5 : 2; break;
                    case 'не вірно': score = reverseItems.includes(i) ? 6 : 1; break;
                }
                total += score;
            }
            
            return { total: total / 46 };
        }

        function calculateDERS() {
            // Зворотне кодування для питань: 1,2,6,7,8,10,17,20,22,24
            const reverseItems = [1,2,6,7,8,10,17,20,22,24];
            
            let total = 0;
            for (let i = 1; i <= 36; i++) {
                const value = parseInt(formData[`ders_${i}`] || 0);
                const score = reverseItems.includes(i) ? (6 - value) : value;
                total += score;
            }
            
            return { total };
        }

        function calculateContentAnalysis() {
            // Простий підрахунок на основі обраних відповідей
            const scores = [];
            
            ['concept_basis', 'creative_impulse', 'novelty_level', 'technical_complexity', 'emotional_content', 'process_awareness', 'self_critical_analysis', 'audience_impact'].forEach(field => {
                const value = formData[field];
                if (value) {
                    // Надати бали від 1 до 5 залежно від позиції у списку
                    scores.push(Math.min(5, scores.length + 1));
                }
            });
            
            return { total: average(scores) };
        }

        function calculateReflectionComponents(results) {
            // Мотиваційно-ціннісний компонент
            const motivational = (results.imi.total + results.es.total) / 2;
            
            // Когнітивно-аналітичний компонент
            const cognitive = (results.cfi.total / 140 * 9 + results.mdmq.vigilance / 10 * 9 + (10 - (results.mdmq.avoidance + results.mdmq.procrastination + results.mdmq.hypervigilance)) / 10 * 9) / 3;
            
            // Операційно-діяльнісний компонент
            const operational = (results.csi.problemSolving + results.csi.socialSupport + (4 - results.csi.avoidance) + results.miq.total) / 4;
            
            // Творчо-регулятивний компонент
            const creative = ((180 - results.ders.total) / 180 * 9 + results.content.total * 9 / 5) / 2;
            
            // Загальний показник
            const overall = (motivational + cognitive + operational + creative) / 4;
            
            return {
                motivational,
                cognitive,
                operational,
                creative,
                overall
            };
        }

        function showResults(results, components) {
            // Приховати форму та показати результати
            document.querySelectorAll('.section').forEach(section => {
                section.style.display = 'none';
            });
            document.querySelector('.navigation').style.display = 'none';
            document.getElementById('resultsSection').style.display = 'block';
            
            // Створити карточки результатів
            const resultsGrid = document.getElementById('resultsGrid');
            resultsGrid.innerHTML = `
                <div class="result-card">
                    <h4>Мотиваційно-ціннісний компонент</h4>
                    <div class="result-value">${components.motivational.toFixed(2)}</div>
                    <p>${getReflectionLevel(components.motivational)}</p>
                </div>
                <div class="result-card">
                    <h4>Когнітивно-аналітичний компонент</h4>
                    <div class="result-value">${components.cognitive.toFixed(2)}</div>
                    <p>${getReflectionLevel(components.cognitive)}</p>
                </div>
                <div class="result-card">
                    <h4>Операційно-діяльнісний компонент</h4>
                    <div class="result-value">${components.operational.toFixed(2)}</div>
                    <p>${getReflectionLevel(components.operational)}</p>
                </div>
                <div class="result-card">
                    <h4>Творчо-регулятивний компонент</h4>
                    <div class="result-value">${components.creative.toFixed(2)}</div>
                    <p>${getReflectionLevel(components.creative)}</p>
                </div>
                <div class="result-card" style="grid-column: 1 / -1; background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%); color: white;">
                    <h4>ЗАГАЛЬНИЙ РІВЕНЬ ПРОФЕСІЙНОЇ РЕФЛЕКСІЇ</h4>
                    <div class="result-value" style="color: white; font-size: 2em;">${components.overall.toFixed(2)}</div>
                    <p style="color: white; font-weight: bold;">${getReflectionLevel(components.overall)}</p>
                </div>
            `;
            
            // Зберегти результати з timestamp
            const finalData = {
                ...formData,
                results,
                components,
                timestamp: new Date().toISOString(),
                completed: true
            };
            
            try {
                localStorage.setItem('choreographyReflectionSurvey', JSON.stringify(finalData));
            } catch (e) {
                console.log('Не вдалося зберегти фінальні результати');
            }
        }

        function getReflectionLevel(score) {
            if (score >= 7.0) return 'Високий рівень';
            if (score >= 4.0) return 'Середній рівень';
            return 'Низький рівень';
        }

        // Функції експорту результатів
        function downloadResults() {
            const data = JSON.parse(localStorage.getItem('choreographyReflectionSurvey') || '{}');
            const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `reflection_survey_results_${new Date().toISOString().split('T')[0]}.json`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
        }

        function emailResults() {
            const data = JSON.parse(localStorage.getItem('choreographyReflectionSurvey') || '{}');
            const subject = 'Результати діагностики професійної рефлексії';
            const body = `Результати анкетування:

Загальний рівень рефлексії: ${data.components?.overall?.toFixed(2) || 'N/A'}

Компоненти:
- Мотиваційно-ціннісний: ${data.components?.motivational?.toFixed(2) || 'N/A'}
- Когнітивно-аналітичний: ${data.components?.cognitive?.toFixed(2) || 'N/A'}
- Операційно-діяльнісний: ${data.components?.operational?.toFixed(2) || 'N/A'}
- Творчо-регулятивний: ${data.components?.creative?.toFixed(2) || 'N/A'}

Дата проходження: ${data.timestamp || 'N/A'}`;
            
            const mailto = `mailto:${data.email || ''}?subject=${encodeURIComponent(subject)}&body=${encodeURIComponent(body)}`;
            window.open(mailto);
        }

        // Допоміжні функції
        function average(arr) {
            return arr.length > 0 ? arr.reduce((sum, val) => sum + val, 0) / arr.length : 0;
        }

        function sum(arr) {
            return arr.reduce((sum, val) => sum + val, 0);
        }

        // Автозбереження кожні 30 секунд
        setInterval(() => {
            if (currentSection > 0) {
                saveCurrentSectionData();
            }
        }, 30000);

        // Попередження про незбережені зміни
        window.addEventListener('beforeunload', function(e) {
            const data = localStorage.getItem('choreographyReflectionSurvey');
            if (data && !JSON.parse(data).completed) {
                e.preventDefault();
                e.returnValue = 'Ваші відповіді можуть бути втрачені. Ви впевнені, що хочете покинути сторінку?';
            }
        });
    </script>

    <!-- EmailJS Library -->
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/@emailjs/browser@3/dist/email.min.js"></script>
    <script type="text/javascript">
        (function() {
            emailjs.init("AbDIRsYbFBdiu7CZW"); // Ваш Public Key
        })();
    </script>
</body>
</html>
